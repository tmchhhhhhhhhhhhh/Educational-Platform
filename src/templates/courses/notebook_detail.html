{% extends 'base.html' %}

{% block head_title %}{{ notebook.title }} - Educational Platform{% endblock %}

{% block content %}
<div class="max-w-[1600px] mx-auto py-10 px-6 text-lg leading-relaxed">

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥ -->
  <div class="mb-8">
    <a href="{% url 'lesson-detail' notebook.lesson.course.id notebook.lesson.id %}" 
       class="text-blue-600 hover:text-blue-800 text-base">
      ‚Üê –ù–∞–∑–∞–¥ –∫ —É—Ä–æ–∫—É: {{ notebook.lesson.title }}
    </a>
  </div>

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <div class="mb-8">
    <h1 class="text-5xl font-bold text-gray-900 mb-3">{{ notebook.title }}</h1>
    {% if notebook.description %}
    <p class="text-gray-700 text-xl">{{ notebook.description }}</p>
    {% endif %}
  </div>

  <!-- –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π -->
  <div class="flex flex-wrap gap-4 mb-10 p-5 bg-white rounded-2xl border border-gray-200">
    {% if binder_url %}
    <a href="{{ binder_url }}" target="_blank"
       class="px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors font-medium flex items-center gap-2 text-lg">
      <span>üöÄ</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Binder
    </a>
    {% endif %}
    
    <a href="{{ notebook.file.url }}" download
       class="px-6 py-3 bg-gray-700 text-white rounded-xl hover:bg-gray-800 transition-colors font-medium flex items-center gap-2 text-lg">
      <span>üì•</span> –°–∫–∞—á–∞—Ç—å .ipynb
    </a>
    
    {% if not binder_url %}
    <div class="text-base text-gray-500 py-2">
      üí° –î–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    </div>
    {% endif %}
  </div>

  <!-- –ü—Ä–µ–≤—å—é –Ω–æ—É—Ç–±—É–∫–∞ -->
  <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden w-full">
    {% if error %}
    <div class="p-10 text-center">
      <div class="text-red-600 mb-3 text-xl">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>
      <p class="text-gray-600 text-lg">{{ error }}</p>
    </div>
    {% elif notebook_html %}

    <style>
      /* –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–≤—å—é */
      .notebook-preview {
        padding: 2rem 3rem;
        background: white;
        width: 100%;
        max-width: none !important;
        font-size: 1.125rem;
        line-height: 1.8;
      }
      .notebook-preview .cell {
        margin-bottom: 1.5rem;
      }
      .notebook-preview .input_area {
        background: #f7f7f7;
        padding: 1.25rem 1.5rem;
        border-radius: 10px;
        border-left: 5px solid #4a90e2;
        margin-bottom: 0.75rem;
      }
      .notebook-preview .output_area {
        padding: 1.25rem 1.5rem;
        background: #fafafa;
        border-radius: 10px;
        border-left: 5px solid #50c878;
      }
      .notebook-preview pre {
        font-family: 'Monaco', 'Menlo', monospace;
        font-size: 1rem;
        overflow-x: auto;
      }
      .notebook-preview table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5rem 0;
      }
      .notebook-preview img {
        max-width: 100%;
        height: auto;
      }
    </style>

    <div class="notebook-preview">
      {{ notebook_html|safe }}
    </div>

    {% else %}
    <div class="p-10 text-center text-gray-500 text-lg">
      <p>–ü—Ä–µ–≤—å—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ Binder/Colab.</p>
    </div>
    {% endif %}
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ—É—Ç–±—É–∫–µ -->
  <div class="mt-8 p-6 bg-blue-50 rounded-xl text-base text-gray-700">
    <p class="mb-3"><strong>üí° –°–æ–≤–µ—Ç:</strong> –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ "–ó–∞–ø—É—Å—Ç–∏—Ç—å".</p>
    {% if notebook.github_repo %}
    <p class="mb-2"><strong>GitHub:</strong> 
      <a href="https://github.com/{{ notebook.github_repo }}" target="_blank" class="text-blue-600 hover:underline">{{ notebook.github_repo }}</a>
    </p>
    {% endif %}
    <p class="mt-2 text-sm text-gray-500">–°–æ–∑–¥–∞–Ω–æ: {{ notebook.created_at|date:"d M Y, H:i" }}</p>
  </div>

</div>
{% endblock %}
